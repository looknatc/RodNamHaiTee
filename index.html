<html ng-app="myApp" lang="en" >
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Rod Nam Hai Tee</title>
    <link rel="stylesheet" href="style.css" />
    <!-- angular js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.8.3/angular.min.js" integrity="sha512-KZmyTq3PLx9EZl0RHShHQuXtrvdJ+m35tuOiwlcZfs/rE7NZv29ygNA8SFCkMXTnYZQK2OX0Gm2qKGfvWEtRXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <!-- moment js -->
    <script src="https://cdn.jsdelivr.net/npm/moment@2.29.3/moment.min.js"></script>    
  </head>
  <body ng-controller="myControl">
    <!-- Header -->
    <div class="header">
      <img src="assets/images/header-background.png" style="width: 100%" />
      <div class="menu_bar">
        <ul>
          <li><a href="">Home</a></li>
          <li><a href="">Data</a></li>
          <li><a href="">Water</a></li>
          <li><a href="">About us</a></li>
          <li><a href="">+</a></li>
        </ul>
      </div>
      <div class="text_block">
        <h1 class="title">Rod Nam Hai Tee</h1>
        <p class="description">
          Automated plant watering system is programmed using Arduino IDE
          software. Arduino microcontroller checks soil moisture level, if low,
          triggering a water pump on until sensor reaches threshold. After this,
          the system will re-check the soil moisture between periodic intervals
          to see if you need more water.
        </p>
      </div>
      <div class="collected-data montserrat-bold-black-48px">Collected Data</div>
      <div class="sensor-data">
        <div class="light">
          <div class=" montserrat-normal-black-32px">Light</div>
          <h1 class="percent">{{light}}%</h1>
          <!-- <img
            class="image-3"
            src="https://anima-uploads.s3.amazonaws.com/projects/627a3db91996a722f08bb46f/releases/627a3dc415efe47701a15528/img/image-3@2x.png"
          /> -->
        </div>
        <div class="temperature">
          <div class=" montserrat-normal-black-32px">Moisture</div>
          <h1 class="percent">{{humidity}}%</h1>
        </div>
        <div class="temperature">
          <div class="montserrat-normal-black-32px">Temperature</div>
          <!-- <img
            class="image-2"
            src="https://anima-uploads.s3.amazonaws.com/projects/627a3db91996a722f08bb46f/releases/627a3dc415efe47701a15528/img/image-2@2x.png"
          /> -->
        </div>
        <div class="temperature">
          <div class="montserrat-normal-black-32px">soil-moisture</div>
          <!-- <img
            class="image-2"
            src="https://anima-uploads.s3.amazonaws.com/projects/627a3db91996a722f08bb46f/releases/627a3dc415efe47701a15528/img/image-2@2x.png"
          /> -->
        </div>
      </div>
      <div class="overlap-group1">
        <div class="watering montserrat-bold-black-48px">Watering</div>
        <img
          class="line-3"
          src="https://anima-uploads.s3.amazonaws.com/projects/627a3db91996a722f08bb46f/releases/627a3dc415efe47701a15528/img/line-2@1x.svg"
        />
        <div class="overlap-group-container-1">
          <div class="overlap-group8">
            <div class="place-1 montserrat-normal-black-32px">Date</div>
            <div class="text-1 montserrat-normal-black-32px">
              29/4/2022&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10:00:00
            </div>
            <div class="text-2 montserrat-normal-black-32px">
              29/4/2022&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10:00:00
            </div>
          </div>
          <div class="overlap-group7">
            <div class="total-amount montserrat-normal-black-32px">Total Amount</div>
            <div class="number">10</div>
          </div>
        </div>
      </div>
      <div>
        <button ng-click="changeTenp('up')">Temp Up</button><button ng-click="changeTenp('down')">Temp Down</button>
        <button ng-click="save()">Save</button>
        <input ng-model="temperature" type="text">
      </div>
      <div>
        Temperature = <span>{{temperature}}</span>
        Humidity = <span>{{humidity}}%</span>
      </div>
    </div>
    <script type="module" src ="index.js"></script>
    <script>
angular.module('myApp', [])
.controller('myControl', function($scope) {
    $scope.temperature = "";
    $scope.humidity = "";
    $scope.light = "";
    $scope.changeTenp = function(dir){
      if(dir == "up"){
        $scope.temperature += 1.0;
      }else{
        $scope.temperature -= 1.0;
      }
    }
    $scope.save = function(){
        var obj = {
          Temperature: $scope.temperature,
          humidity:  $scope.humidity,
        }
        console.log("save",obj);
    }
    $scope.loadData = async function(){
        var ret = await getAllDataByDate();
        $scope.$apply(function () {
            var last = ret[ret.length -1];
            console.log("loadData",last);
            $scope.temperature = last.temperature;
            $scope.humidity = last.humidity;
            $scope.light = last.light;
        });
    }

    $scope.loadData();

});      
    </script>
  </body>
</html>
